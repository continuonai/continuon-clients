{% extends "base_v2.html" %}

{% block title %}Find My Robot - Continuon Brain{% endblock %}

{% block extra_styles %}
/* Hide the agent rail on connect page for cleaner onboarding */
.agent-rail {
    display: none !important;
}

.app-shell {
    grid-template-columns: var(--nav-width) 1fr !important;
}

/* Connect Page Styles */
.connect-layout {
    display: flex;
    flex-direction: column;
    align-items: center;
    max-width: 600px;
    margin: 0 auto;
    gap: 24px;
}

.connect-hero {
    text-align: center;
    padding: 20px 0;
}

.connect-hero-icon {
    font-size: 64px;
    margin-bottom: 16px;
    animation: float 3s ease-in-out infinite;
}

@keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}

.connect-title {
    font-family: var(--font-display);
    font-size: 28px;
    font-weight: 700;
    margin-bottom: 8px;
}

.connect-subtitle {
    color: var(--text-secondary);
    font-size: 15px;
    max-width: 400px;
    margin: 0 auto;
}

/* Scanner Section */
.scanner-section {
    width: 100%;
    background: var(--bg-surface);
    border: 1px solid var(--border-subtle);
    border-radius: 16px;
    overflow: hidden;
}

.scanner-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 20px;
    background: var(--bg-elevated);
    border-bottom: 1px solid var(--border-subtle);
}

.scanner-title {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 14px;
    font-weight: 600;
}

.scanner-status {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    color: var(--text-muted);
}

.scanner-status-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--text-muted);
}

.scanner-status-dot.active {
    background: var(--accent-success);
    animation: pulse 1.5s infinite;
}

.scanner-status-dot.scanning {
    background: var(--accent-warning);
    animation: pulse 0.5s infinite;
}

.scanner-body {
    padding: 20px;
}

/* Camera Preview */
.camera-container {
    position: relative;
    width: 100%;
    aspect-ratio: 4/3;
    background: var(--bg-deep);
    border-radius: 12px;
    overflow: hidden;
    margin-bottom: 16px;
}

.camera-video {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.camera-canvas {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
}

.camera-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
}

.scan-frame {
    width: 200px;
    height: 200px;
    border: 3px solid var(--accent-primary);
    border-radius: 20px;
    box-shadow: 0 0 0 4000px rgba(0, 0, 0, 0.5);
    animation: scan-pulse 2s ease-in-out infinite;
}

@keyframes scan-pulse {
    0%, 100% { border-color: var(--accent-primary); }
    50% { border-color: var(--accent-success); }
}

.scan-line {
    position: absolute;
    width: 180px;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--accent-primary), transparent);
    animation: scan-line 2s linear infinite;
}

@keyframes scan-line {
    0% { top: calc(50% - 90px); }
    100% { top: calc(50% + 90px); }
}

.camera-placeholder {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    color: var(--text-muted);
    gap: 12px;
}

.camera-placeholder-icon {
    font-size: 48px;
    opacity: 0.5;
}

.camera-placeholder-text {
    font-size: 14px;
}

/* Camera Controls */
.camera-controls {
    display: flex;
    gap: 12px;
    justify-content: center;
}

.camera-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 12px 24px;
    background: var(--accent-primary);
    border: none;
    border-radius: 12px;
    color: white;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all var(--duration-fast);
}

.camera-btn:hover {
    filter: brightness(1.1);
    transform: translateY(-2px);
}

.camera-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
}

.camera-btn.secondary {
    background: var(--bg-elevated);
    border: 1px solid var(--border-subtle);
    color: var(--text-secondary);
}

.camera-btn.secondary:hover {
    border-color: var(--accent-primary);
    color: var(--accent-primary);
}

.camera-btn.success {
    background: var(--accent-success);
}

/* Manual Entry */
.manual-section {
    width: 100%;
    background: var(--bg-surface);
    border: 1px solid var(--border-subtle);
    border-radius: 16px;
    overflow: hidden;
}

.manual-header {
    padding: 16px 20px;
    background: var(--bg-elevated);
    border-bottom: 1px solid var(--border-subtle);
    font-size: 14px;
    font-weight: 600;
}

.manual-body {
    padding: 20px;
}

.input-group {
    margin-bottom: 16px;
}

.input-label {
    display: block;
    font-size: 12px;
    color: var(--text-secondary);
    margin-bottom: 6px;
}

.input-field {
    width: 100%;
    padding: 12px 16px;
    background: var(--bg-elevated);
    border: 1px solid var(--border-subtle);
    border-radius: 10px;
    color: var(--text-primary);
    font-family: var(--font-mono);
    font-size: 14px;
    outline: none;
    transition: all var(--duration-fast);
}

.input-field:focus {
    border-color: var(--accent-primary);
    box-shadow: 0 0 0 3px var(--accent-primary-dim);
}

.input-field::placeholder {
    color: var(--text-muted);
    font-family: var(--font-ui);
}

.input-hint {
    font-size: 11px;
    color: var(--text-muted);
    margin-top: 6px;
}

/* Robot Found Card */
.robot-found-card {
    width: 100%;
    background: linear-gradient(135deg, var(--bg-surface) 0%, var(--accent-success-dim) 100%);
    border: 2px solid var(--accent-success);
    border-radius: 16px;
    padding: 24px;
    text-align: center;
    display: none;
}

.robot-found-card.visible {
    display: block;
    animation: slideUp 0.3s ease-out;
}

@keyframes slideUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

.robot-found-icon {
    font-size: 48px;
    margin-bottom: 12px;
}

.robot-found-title {
    font-size: 18px;
    font-weight: 700;
    margin-bottom: 4px;
    color: var(--accent-success);
}

.robot-found-name {
    font-family: var(--font-display);
    font-size: 24px;
    font-weight: 700;
    margin-bottom: 8px;
}

.robot-found-ruri {
    font-family: var(--font-mono);
    font-size: 12px;
    color: var(--text-secondary);
    margin-bottom: 16px;
    word-break: break-all;
}

.robot-found-actions {
    display: flex;
    gap: 12px;
    justify-content: center;
    flex-wrap: wrap;
}

.connect-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 14px 28px;
    background: var(--accent-success);
    border: none;
    border-radius: 12px;
    color: white;
    font-size: 15px;
    font-weight: 700;
    cursor: pointer;
    transition: all var(--duration-fast);
}

.connect-btn:hover {
    filter: brightness(1.1);
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(16, 185, 129, 0.3);
}

/* Recent Robots */
.recent-section {
    width: 100%;
    background: var(--bg-surface);
    border: 1px solid var(--border-subtle);
    border-radius: 16px;
    overflow: hidden;
}

.recent-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 20px;
    background: var(--bg-elevated);
    border-bottom: 1px solid var(--border-subtle);
}

.recent-title {
    font-size: 14px;
    font-weight: 600;
}

.recent-clear {
    font-size: 12px;
    color: var(--text-muted);
    background: none;
    border: none;
    cursor: pointer;
}

.recent-clear:hover {
    color: var(--accent-danger);
}

.recent-list {
    padding: 12px;
}

.recent-robot {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px;
    background: var(--bg-elevated);
    border: 1px solid var(--border-subtle);
    border-radius: 10px;
    margin-bottom: 8px;
    cursor: pointer;
    transition: all var(--duration-fast);
}

.recent-robot:last-child {
    margin-bottom: 0;
}

.recent-robot:hover {
    border-color: var(--accent-primary);
    transform: translateX(4px);
}

.recent-robot-icon {
    width: 40px;
    height: 40px;
    background: var(--accent-primary-dim);
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
}

.recent-robot-info {
    flex: 1;
}

.recent-robot-name {
    font-size: 14px;
    font-weight: 600;
    margin-bottom: 2px;
}

.recent-robot-ruri {
    font-family: var(--font-mono);
    font-size: 11px;
    color: var(--text-muted);
}

.recent-robot-status {
    font-size: 11px;
    padding: 4px 8px;
    border-radius: 12px;
    background: var(--bg-glass);
    color: var(--text-muted);
}

.recent-robot-status.online {
    background: var(--accent-success-dim);
    color: var(--accent-success);
}

/* Help Tips */
.help-tips {
    width: 100%;
    background: var(--bg-glass);
    border: 1px solid var(--border-subtle);
    border-radius: 12px;
    padding: 16px;
}

.help-tips-title {
    font-size: 13px;
    font-weight: 600;
    margin-bottom: 12px;
    color: var(--accent-info);
}

.help-tips-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.help-tip {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    font-size: 12px;
    color: var(--text-secondary);
}

.help-tip-icon {
    flex-shrink: 0;
}

@media (max-width: 600px) {
    .connect-layout {
        padding: 0 8px;
    }

    .scan-frame {
        width: 160px;
        height: 160px;
    }

    .camera-controls {
        flex-direction: column;
    }

    .camera-btn {
        width: 100%;
        justify-content: center;
    }
}
{% endblock %}

{% block content %}
<div class="connect-layout">
    <!-- Hero -->
    <div class="connect-hero">
        <div class="connect-hero-icon">üîç</div>
        <h1 class="connect-title">Find My Robot</h1>
        <p class="connect-subtitle">Scan the QR code on your robot or enter its address to connect and start chatting with HOPE</p>
    </div>

    <!-- Robot Found Card (hidden until scan succeeds) -->
    <div class="robot-found-card" id="robot-found-card">
        <div class="robot-found-icon">üéâ</div>
        <div class="robot-found-title">Robot Found!</div>
        <div class="robot-found-name" id="found-robot-name">My Robot</div>
        <div class="robot-found-ruri" id="found-robot-ruri">rcan://...</div>
        <div class="robot-found-actions">
            <button class="connect-btn" onclick="connectToRobot()">
                <span>ü§ñ</span> Connect & Chat
            </button>
            <button class="camera-btn secondary" onclick="dismissFound()">
                Scan Another
            </button>
        </div>
    </div>

    <!-- QR Scanner -->
    <div class="scanner-section" id="scanner-section">
        <div class="scanner-header">
            <div class="scanner-title">
                <span>üì∑</span>
                <span>QR Code Scanner</span>
            </div>
            <div class="scanner-status" id="scanner-status">
                <span class="scanner-status-dot" id="scanner-dot"></span>
                <span id="scanner-status-text">Ready</span>
            </div>
        </div>
        <div class="scanner-body">
            <div class="camera-container" id="camera-container">
                <video class="camera-video" id="camera-video" playsinline autoplay muted></video>
                <canvas class="camera-canvas" id="camera-canvas"></canvas>
                <div class="camera-overlay" id="camera-overlay" style="display: none;">
                    <div class="scan-frame">
                        <div class="scan-line"></div>
                    </div>
                </div>
                <div class="camera-placeholder" id="camera-placeholder">
                    <div class="camera-placeholder-icon">üì∏</div>
                    <div class="camera-placeholder-text">Tap "Start Camera" to begin scanning</div>
                </div>
            </div>
            <div class="camera-controls">
                <button class="camera-btn" id="start-camera-btn" onclick="startCamera()">
                    <span>üì∑</span> Start Camera
                </button>
                <button class="camera-btn secondary" id="stop-camera-btn" onclick="stopCamera()" style="display: none;">
                    <span>‚èπÔ∏è</span> Stop
                </button>
                <button class="camera-btn secondary" id="switch-camera-btn" onclick="switchCamera()" style="display: none;">
                    <span>üîÑ</span> Switch Camera
                </button>
            </div>
        </div>
    </div>

    <!-- Manual Entry -->
    <div class="manual-section">
        <div class="manual-header">üìù Or Enter Manually</div>
        <div class="manual-body">
            <div class="input-group">
                <label class="input-label">Robot Address (RURI or URL)</label>
                <input type="text" class="input-field" id="manual-address"
                       placeholder="rcan://continuon/my-robot or http://192.168.1.100:8080"
                       onkeypress="if(event.key==='Enter') lookupRobot()">
                <div class="input-hint">Enter the RCAN RURI or local IP address of your robot</div>
            </div>
            <button class="camera-btn" onclick="lookupRobot()" style="width: 100%; justify-content: center;">
                <span>üîé</span> Find Robot
            </button>
        </div>
    </div>

    <!-- Recent Robots -->
    <div class="recent-section" id="recent-section" style="display: none;">
        <div class="recent-header">
            <span class="recent-title">üïê Recently Connected</span>
            <button class="recent-clear" onclick="clearRecentRobots()">Clear All</button>
        </div>
        <div class="recent-list" id="recent-list">
            <!-- Populated dynamically -->
        </div>
    </div>

    <!-- Help Tips -->
    <div class="help-tips">
        <div class="help-tips-title">üí° Tips</div>
        <div class="help-tips-list">
            <div class="help-tip">
                <span class="help-tip-icon">üìç</span>
                <span>Look for the QR code sticker on your robot's body or check the robot's screen</span>
            </div>
            <div class="help-tip">
                <span class="help-tip-icon">üåê</span>
                <span>Make sure your phone/tablet is on the same WiFi network as the robot</span>
            </div>
            <div class="help-tip">
                <span class="help-tip-icon">üí¨</span>
                <span>Once connected, you can chat with HOPE - your robot's AI assistant</span>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
// Load jsQR library for QR code scanning
const jsQRScript = document.createElement('script');
jsQRScript.src = 'https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js';
document.head.appendChild(jsQRScript);

let videoStream = null;
let scanInterval = null;
let currentFacingMode = 'environment'; // Start with back camera
let foundRobot = null;

// Camera functions
async function startCamera() {
    try {
        updateScannerStatus('starting', 'Starting camera...');

        const constraints = {
            video: {
                facingMode: currentFacingMode,
                width: { ideal: 1280 },
                height: { ideal: 720 }
            }
        };

        videoStream = await navigator.mediaDevices.getUserMedia(constraints);

        const video = document.getElementById('camera-video');
        video.srcObject = videoStream;
        await video.play();

        document.getElementById('camera-placeholder').style.display = 'none';
        document.getElementById('camera-overlay').style.display = 'flex';
        document.getElementById('start-camera-btn').style.display = 'none';
        document.getElementById('stop-camera-btn').style.display = 'flex';
        document.getElementById('switch-camera-btn').style.display = 'flex';

        updateScannerStatus('scanning', 'Scanning for QR codes...');

        // Start scanning
        startScanning();

    } catch (error) {
        console.error('Camera error:', error);
        updateScannerStatus('error', 'Camera access denied');
        alert('Could not access camera. Please allow camera permissions and try again.');
    }
}

function stopCamera() {
    if (videoStream) {
        videoStream.getTracks().forEach(track => track.stop());
        videoStream = null;
    }

    if (scanInterval) {
        clearInterval(scanInterval);
        scanInterval = null;
    }

    const video = document.getElementById('camera-video');
    video.srcObject = null;

    document.getElementById('camera-placeholder').style.display = 'flex';
    document.getElementById('camera-overlay').style.display = 'none';
    document.getElementById('start-camera-btn').style.display = 'flex';
    document.getElementById('stop-camera-btn').style.display = 'none';
    document.getElementById('switch-camera-btn').style.display = 'none';

    updateScannerStatus('ready', 'Ready');
}

async function switchCamera() {
    currentFacingMode = currentFacingMode === 'environment' ? 'user' : 'environment';
    stopCamera();
    await startCamera();
}

function startScanning() {
    const video = document.getElementById('camera-video');
    const canvas = document.getElementById('camera-canvas');
    const ctx = canvas.getContext('2d');

    scanInterval = setInterval(() => {
        if (video.readyState !== video.HAVE_ENOUGH_DATA) return;
        if (typeof jsQR === 'undefined') return; // Wait for library to load

        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        ctx.drawImage(video, 0, 0);

        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        const code = jsQR(imageData.data, imageData.width, imageData.height, {
            inversionAttempts: 'dontInvert'
        });

        if (code) {
            handleQRCode(code.data);
        }
    }, 100); // Scan every 100ms
}

function handleQRCode(data) {
    console.log('QR Code detected:', data);

    // Parse the QR data
    let robotInfo = parseRobotQR(data);

    if (robotInfo) {
        // Success! Show the found robot
        foundRobot = robotInfo;
        showFoundRobot(robotInfo);
        stopCamera();

        // Vibrate for feedback (if supported)
        if (navigator.vibrate) {
            navigator.vibrate(200);
        }
    }
}

function parseRobotQR(data) {
    // Try to parse different QR formats

    // Format 1: RCAN RURI (rcan://creator/robot-name)
    if (data.startsWith('rcan://')) {
        const parts = data.replace('rcan://', '').split('/');
        return {
            type: 'ruri',
            ruri: data,
            creator: parts[0] || 'unknown',
            name: parts[1] || 'Robot',
            url: null
        };
    }

    // Format 2: HTTP URL (http://ip:port or https://...)
    if (data.startsWith('http://') || data.startsWith('https://')) {
        return {
            type: 'url',
            ruri: null,
            creator: null,
            name: 'Robot',
            url: data
        };
    }

    // Format 3: JSON format
    try {
        const json = JSON.parse(data);
        if (json.ruri || json.url || json.host) {
            return {
                type: 'json',
                ruri: json.ruri || null,
                creator: json.creator || null,
                name: json.name || json.robot_name || 'Robot',
                url: json.url || (json.host ? `http://${json.host}:${json.port || 8080}` : null)
            };
        }
    } catch (e) {
        // Not JSON
    }

    // Format 4: Plain IP:Port
    const ipMatch = data.match(/^(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}):?(\d+)?$/);
    if (ipMatch) {
        return {
            type: 'ip',
            ruri: null,
            creator: null,
            name: 'Robot',
            url: `http://${ipMatch[1]}:${ipMatch[2] || 8080}`
        };
    }

    return null;
}

function showFoundRobot(info) {
    document.getElementById('found-robot-name').textContent = info.name;
    document.getElementById('found-robot-ruri').textContent = info.ruri || info.url || 'Unknown address';
    document.getElementById('robot-found-card').classList.add('visible');
    document.getElementById('scanner-section').style.display = 'none';

    updateScannerStatus('found', 'Robot found!');

    // Save to recent
    saveRecentRobot(info);
}

function dismissFound() {
    document.getElementById('robot-found-card').classList.remove('visible');
    document.getElementById('scanner-section').style.display = 'block';
    foundRobot = null;
    updateScannerStatus('ready', 'Ready');
}

async function connectToRobot() {
    if (!foundRobot) return;

    // Navigate to the robot's dashboard or agent chat
    let targetUrl = '/agent'; // Default to agent chat on current server

    if (foundRobot.url) {
        // If we have a URL, navigate there
        targetUrl = foundRobot.url;
    }

    // Try to verify the robot is reachable first
    try {
        const checkUrl = foundRobot.url || window.location.origin;
        const response = await fetch(`${checkUrl}/api/status`, {
            method: 'GET',
            mode: 'cors',
            timeout: 5000
        });

        if (response.ok) {
            // Robot is reachable, go to agent page
            window.location.href = foundRobot.url ? `${foundRobot.url}/agent` : '/agent';
        } else {
            throw new Error('Robot not responding');
        }
    } catch (error) {
        console.error('Connection error:', error);
        // Still try to navigate
        if (foundRobot.url) {
            if (confirm(`Could not verify robot at ${foundRobot.url}. Try connecting anyway?`)) {
                window.location.href = `${foundRobot.url}/agent`;
            }
        } else {
            window.location.href = '/agent';
        }
    }
}

// Manual lookup
async function lookupRobot() {
    const input = document.getElementById('manual-address').value.trim();
    if (!input) {
        alert('Please enter a robot address');
        return;
    }

    const robotInfo = parseRobotQR(input);

    if (!robotInfo) {
        // Try as plain URL
        if (input.includes('.') || input.includes(':')) {
            foundRobot = {
                type: 'manual',
                ruri: null,
                creator: null,
                name: 'Robot',
                url: input.startsWith('http') ? input : `http://${input}`
            };
            showFoundRobot(foundRobot);
        } else {
            alert('Could not parse robot address. Please enter a valid RURI or URL.');
        }
        return;
    }

    foundRobot = robotInfo;
    showFoundRobot(robotInfo);
}

// Recent robots
function saveRecentRobot(info) {
    let recent = JSON.parse(localStorage.getItem('recentRobots') || '[]');

    // Remove duplicate if exists
    recent = recent.filter(r => (r.ruri !== info.ruri || !info.ruri) && (r.url !== info.url || !info.url));

    // Add to front
    recent.unshift({
        ...info,
        lastConnected: Date.now()
    });

    // Keep only last 5
    recent = recent.slice(0, 5);

    localStorage.setItem('recentRobots', JSON.stringify(recent));
    loadRecentRobots();
}

function loadRecentRobots() {
    const recent = JSON.parse(localStorage.getItem('recentRobots') || '[]');
    const section = document.getElementById('recent-section');
    const list = document.getElementById('recent-list');

    if (recent.length === 0) {
        section.style.display = 'none';
        return;
    }

    section.style.display = 'block';
    list.innerHTML = recent.map(robot => `
        <div class="recent-robot" onclick="selectRecentRobot('${escapeHtml(JSON.stringify(robot))}')">
            <div class="recent-robot-icon">ü§ñ</div>
            <div class="recent-robot-info">
                <div class="recent-robot-name">${escapeHtml(robot.name)}</div>
                <div class="recent-robot-ruri">${escapeHtml(robot.ruri || robot.url || 'Unknown')}</div>
            </div>
            <div class="recent-robot-status">Tap to connect</div>
        </div>
    `).join('');
}

function selectRecentRobot(jsonStr) {
    const robot = JSON.parse(jsonStr);
    foundRobot = robot;
    showFoundRobot(robot);
}

function clearRecentRobots() {
    if (confirm('Clear all recent robots?')) {
        localStorage.removeItem('recentRobots');
        loadRecentRobots();
    }
}

// UI helpers
function updateScannerStatus(state, text) {
    const dot = document.getElementById('scanner-dot');
    const statusText = document.getElementById('scanner-status-text');

    dot.className = 'scanner-status-dot';

    switch (state) {
        case 'scanning':
            dot.classList.add('scanning');
            break;
        case 'found':
        case 'active':
            dot.classList.add('active');
            break;
    }

    statusText.textContent = text;
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
    loadRecentRobots();

    // Check if camera is available
    if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
        document.getElementById('scanner-section').innerHTML = `
            <div class="scanner-header">
                <div class="scanner-title">
                    <span>üì∑</span>
                    <span>QR Code Scanner</span>
                </div>
            </div>
            <div class="scanner-body" style="text-align: center; padding: 40px;">
                <div style="font-size: 48px; margin-bottom: 16px;">üìµ</div>
                <div style="color: var(--text-secondary);">Camera not available on this device.</div>
                <div style="color: var(--text-muted); font-size: 12px; margin-top: 8px;">Use manual entry below to connect to your robot.</div>
            </div>
        `;
    }
});
{% endblock %}
